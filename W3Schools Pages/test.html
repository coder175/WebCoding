<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Collision Detection</title>
    <style>
        #game-board {
            position: relative;
            width: 800px;
            height: 600px;
            border: 1px solid black;
        }

        .rock, #player {
            position: absolute;
            width: 50px;
            height: 50px;
        }

        .rock {
            background-color: gray;
        }

        #player {
            background-color: blue;
        }
    </style>
</head>
<body>
<div id="game-board">
    <div id="player"></div>
    <div class="rock" style="left: 100px; top: 100px;"></div>
    <div class="rock" style="left: 200px; top: 200px;"></div>
    <!-- Add more rock divs as needed -->
</div>

<script>
    document.addEventListener('DOMContentLoaded', (event) => {
        const player = document.getElementById('player');
        const rocks = document.querySelectorAll('.rock');
        const step = 200; // Pixels per second

        let moveDirection = {x: 0, y: 0};
        let lastTimestamp = 0;
        let animationId = null;

        player.style.left = '0px';
        player.style.top = '0px';

        function checkCollision(newLeft, newTop) {
            const playerRect = player.getBoundingClientRect();

            for (let rock of rocks) {
                const rockRect = rock.getBoundingClientRect();

                if (
                    newLeft < rockRect.right &&
                    newLeft + playerRect.width > rockRect.left &&
                    newTop < rockRect.bottom &&
                    newTop + playerRect.height > rockRect.top
                ) {
                    return true;
                }
            }
            return false;
        }

        function movePlayer(timestamp) {
            if (!lastTimestamp) lastTimestamp = timestamp;
            const deltaTime = timestamp - lastTimestamp;

            const playerRect = player.getBoundingClientRect();
            const boardRect = player.parentElement.getBoundingClientRect();

            const dx = moveDirection.x * (deltaTime / 1000) * step;
            const dy = moveDirection.y * (deltaTime / 1000) * step;

            let newLeft = playerRect.left + dx;
            let newTop = playerRect.top + dy;

            // Check for collision with board boundaries
            if (newLeft < boardRect.left) newLeft = boardRect.left;
            if (newLeft + playerRect.width > boardRect.right) newLeft = boardRect.right - playerRect.width;
            if (newTop < boardRect.top) newTop = boardRect.top;
            if (newTop + playerRect.height > boardRect.bottom) newTop = boardRect.bottom - playerRect.height;

            // Check for collision with rocks
            if (!checkCollision(newLeft, newTop)) {
                player.style.left = newLeft - boardRect.left + 'px';
                player.style.top = newTop - boardRect.top + 'px';
            }

            lastTimestamp = timestamp;
            animationId = requestAnimationFrame(movePlayer);
        }

        function startAnimation() {
            if (animationId === null) {
                lastTimestamp = null;
                animationId = requestAnimationFrame(movePlayer);
            }
        }

        function stopAnimation() {
            cancelAnimationFrame(animationId);
            animationId = null;
        }

        function handleKeyDown(event) {
            switch (event.key) {
                case 'w':
                    moveDirection.y = -1;
                    startAnimation();
                    break;
                case 'a':
                    moveDirection.x = -1;
                    startAnimation();
                    break;
                case 's':
                    moveDirection.y = 1;
                    startAnimation();
                    break;
                case 'd':
                    moveDirection.x = 1;
                    startAnimation();
                    break;
            }
        }

        function handleKeyUp(event) {
            switch (event.key) {
                case 'w':
                case 's':
                    moveDirection.y = 0;
                    break;
                case 'a':
                case 'd':
                    moveDirection.x = 0;
                    break;
            }
            if (moveDirection.x === 0 && moveDirection.y === 0) {
                stopAnimation();
            }
        }

        document.addEventListener('keydown', handleKeyDown);
        document.addEventListener('keyup', handleKeyUp);
    });


</script>
</body>
</html>
